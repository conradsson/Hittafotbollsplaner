@model Hittafotbollsplaner.Models.fotbollsplaner

@{
    ViewBag.Title = "Lägg till fotbollsplan";
}

<script>
    $("#hideNav").click(function () {
        $(".navbar").toggle();
    });
</script>

@if (@ViewBag.SuccessConfirm != null)
{
    @Html.Partial("_SuccessConfirmation")
}

<div class="row ontoppageNyplan content">
    <div class="panel-body">

        @using (Html.BeginForm())
        {
            @Html.AntiForgeryToken()

                <div class="form-horizontal">
                    <div class="toppanel"><h3 class="panel-title text-center" style="margin-bottom: 2%; font-size:x-large;">Lägg till fotbollsplan</h3></div>


                    <div class="container-generellinfo col-md-12">
                        <div class="genInfoSlide text-center">Generell information <span id="genInfoSlideIco" class="glyphicon glyphicon-chevron-down" aria-hidden="true"></span></div>
                        <div id="G-toggle">
                            <span class="glyphicon glyphicon-question-sign pull-right hjalpKnapp" aria-hidden="true" style="margin-right:2%; "><span class="hjalpText">Vänligen markera på kartan vart fotbollsplanen ligger, uppgifterna fylls då i automatiskt. Fyll sedan i det som saknas eller ändra det som är felaktigt. <br /><br /> Hemsida är ej obligatoriskt.</span></span>

                            <div class="col-md-6">
                                <div class="col-md-12" style="text-align: center;">
                                    <label class="text-center" for="Karta">Markera vart på kartan fotbollsplanen ligger<span class="red">*</span></label><br />

                                </div>
                                <div class="col-md-12 col-kart">
                                    <span id="getPosCre" class="btn btn-default"><img src="~/Content/img/loc.png" /></span>

                                    <div id="googleMap" style="width:100%;height:370px;"></div>
                                </div>
                            </div>
                            <script>
                                var oldMarker;
                                var marker;

                                function myMap() {
                                    var myCenter = new google.maps.LatLng(61.5376, 15.5063);
                                    var mapCanvas = document.getElementById("googleMap");
                                    var mapOptions = {
                                        center: myCenter,
                                        zoom: 5,
                                        minZoom: 5,
                                        styles: [
{
    "featureType": "administrative.country",
    "elementType": "geometry.stroke",
    "stylers": [
      {
          "lightness": -65
      }
    ]
},
{
    "featureType": "administrative.province",
    "elementType": "geometry.stroke",
    "stylers": [
      {
          "lightness": -75
      }
    ]
},
{
    "featureType": "landscape.natural",
    "elementType": "geometry.fill",
    "stylers": [
      {
          "color": "#ffffff"
      }
    ]
},
{
    "featureType": "landscape.natural",
    "elementType": "geometry.stroke",
    "stylers": [
      {
          "color": "#00ff40"
      }
    ]
},
{
    "featureType": "landscape.natural.terrain",
    "elementType": "geometry.fill",
    "stylers": [
      {
          "lightness": -15
      }
    ]
},
{
    "featureType": "road.arterial",
    "elementType": "geometry.fill",
    "stylers": [
      {
          "lightness": -35
      }
    ]
},
{
    "featureType": "road.arterial",
    "elementType": "labels",
    "stylers": [
      {
          "visibility": "off"
      }
    ]
},
{
    "featureType": "road.highway",
    "elementType": "geometry.fill",
    "stylers": [
      {
          "color": "#8f8f8f"
      },
      {
          "lightness": -30
      },
      {
          "visibility": "off"
      }
    ]
},
{
    "featureType": "road.highway",
    "elementType": "geometry.stroke",
    "stylers": [
      {
          "color": "#a6a6a6"
      }
    ]
},
{
    "featureType": "road.highway",
    "elementType": "labels",
    "stylers": [
      {
          "visibility": "off"
      }
    ]
},
{
    "featureType": "road.local",
    "stylers": [
      {
          "visibility": "off"
      }
    ]
},
{
    "featureType": "water",
    "elementType": "geometry",
    "stylers": [
      {
          "lightness": -40
      }
    ]
},
{
    "featureType": "water",
    "elementType": "geometry.fill",
    "stylers": [
      {
          "lightness": 55
      }
    ]
}
                                        ]
                                    };
                                    var map = new google.maps.Map(mapCanvas, mapOptions);
                                    var icon = {
                                        url: "/Content/img/marker.png", // url
                                        scaledSize: new google.maps.Size(32, 50), // scaled size
                                        origin: new google.maps.Point(0, 0), // origin
                                        anchor: new google.maps.Point(20, 50) // anchor
                                    };

                                    // HITTA POSTION
                                    $("span#getPosCre").click(function () {

                                        var myloc = new google.maps.Marker({
                                            clickable: false,
                                            icon: new google.maps.MarkerImage('//maps.gstatic.com/mapfiles/mobile/mobileimgs2.png',
                                                                                            new google.maps.Size(22, 22),
                                                                                            new google.maps.Point(0, 18),
                                                                                            new google.maps.Point(11, 11)),
                                            shadow: null,
                                            zIndex: 999,
                                            map: map
                                        });

                                        if (navigator.geolocation) navigator.geolocation.getCurrentPosition(function (pos) {
                                            var me = new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude);
                                            myloc.setPosition(me);
                                            map.panTo(me);
                                            map.setZoom(10);
                                        }, function (error) {
                                            // ...
                                        });

                                    });

                                    var geocoder = new google.maps.Geocoder();

                                    google.maps.event.addListener(map, 'click', function (event) {
                                        placeMarker(event.latLng);
                                        var position = marker.getPosition();
                                        var latitude = position.lat();
                                        var longitude = position.lng();

                                        geocoder.geocode({
                                            'latLng': event.latLng
                                        }, function (results, status) {
                                            if (status == google.maps.GeocoderStatus.OK) {
                                                if (results[0]) {

                                                    function capitalize(string) {
                                                        return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase();
                                                    }

                                                    var helaAdressen = results[0].formatted_address;
                                                    var adress = helaAdressen.split(',')[0];
                                                    capitalize(adress);
                                                    var postnummerStad = helaAdressen.split(',')[1];
                                                    var postnummer = postnummerStad.substring(1, 7);
                                                    var stad = postnummerStad.substring(8);
                                                    $('#adress').val(adress);
                                                    $('#postnummer').val(postnummer);
                                                    $('#ort').val(stad);
                                                }
                                            }
                                        });



                                        $('#lat1').val(latitude);
                                        $('#long1').val(longitude);
                                    });
                                    function placeMarker(location) {
                                        marker = new google.maps.Marker({
                                            position: location,
                                            icon: icon,
                                            map: map
                                        });

                                        if (oldMarker != undefined) {
                                            oldMarker.setMap(null);
                                        }
                                        oldMarker = marker;
                                        map.setCenter(location);
                                    }
                                }
                            </script>

                            <div class="col-md-4">
                                <div class="col-md-offset-12" style="visibility:hidden;">.</div>
                                @Html.ValidationSummary(true, "", new { @class = "text-danger", required = "required" })

                                <div class="form-group">
                                    <label class="control-label col-md-4" for="Namn">Namn<span class="red">*</span></label>
                                    <div class="col-md-8">
                                        @Html.EditorFor(model => model.Namn, new { htmlAttributes = new { @class = "form-control" } })
                                        @Html.ValidationMessageFor(model => model.Namn, "", new { @class = "text-danger" })
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="control-label col-md-4" for="Adress">Adress<span class="red">*</span></label>
                                    <div class="col-md-8">
                                        @Html.EditorFor(model => model.Adress, new { htmlAttributes = new { @class = "form-control", @id = "adress" } })
                                        @Html.ValidationMessageFor(model => model.Adress, "", new { @class = "text-danger" })
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="control-label col-md-4" for="Postnummer">Postnummer<span class="red">*</span></label>
                                    <div class="col-md-8">
                                        @Html.EditorFor(model => model.Postnummer, new { htmlAttributes = new { @class = "form-control", @id = "postnummer" } })
                                        @Html.ValidationMessageFor(model => model.Postnummer, "", new { @class = "text-danger" })
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="control-label col-md-4" for="Ort">Ort<span class="red">*</span></label>
                                    <div class="col-md-8">
                                        @Html.EditorFor(model => model.Ort, new { htmlAttributes = new { @class = "form-control", @id = "ort" } })
                                        @Html.ValidationMessageFor(model => model.Ort, "", new { @class = "text-danger" })
                                    </div>
                                </div>

                                <div class="form-group">
                                    @Html.LabelFor(model => model.Hemsida, htmlAttributes: new { @class = "control-label col-md-4" })
                                    <div class="col-md-8">
                                        @Html.EditorFor(model => model.Hemsida, new { htmlAttributes = new { @class = "form-control", @placeholder = "https://" } })
                                        @Html.ValidationMessageFor(model => model.Hemsida, "", new { @class = "text-danger" })
                                    </div>
                                </div>

                                <!-- START DOLDA -->
                                <div id="lat" class="form-group" style="position:absolute; z-index: -10; margin-top: -20%;">
                                    @Html.LabelFor(model => model.Latitud, htmlAttributes: new { @class = "control-label col-md-4" })
                                    <div class="col-md-8">
                                        @Html.EditorFor(model => model.Latitud, new { htmlAttributes = new { @class = "form-control", @id = "lat1" } })
                                        @Html.ValidationMessageFor(model => model.Latitud, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <div id="long" class="form-group" style="position:absolute; z-index: -10; margin-top: -20%;">
                                    @Html.LabelFor(model => model.Longitud, htmlAttributes: new { @class = "control-label col-md-2" })
                                    <div class="col-md-10">
                                        @Html.EditorFor(model => model.Longitud, new { htmlAttributes = new { @class = "form-control", @id = "long1" } })
                                        @Html.ValidationMessageFor(model => model.Longitud, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <!-- DOLDA SLUT -->

                            </div>
                            <div class="col-md-2"></div>
                        </div>
                    </div>

                @{
                    List<SelectListItem> antalPlaner = new List<SelectListItem>();
                    antalPlaner.Add(new SelectListItem
                    {
                        Text = "0",
                        Value = "0"
                    });
                    antalPlaner.Add(new SelectListItem
                    {
                        Text = "1",
                        Value = "1",
                    });
                    antalPlaner.Add(new SelectListItem
                    {
                        Text = "2",
                        Value = "2",
                    });
                    antalPlaner.Add(new SelectListItem
                    {
                        Text = "3",
                        Value = "3",
                    });
                    antalPlaner.Add(new SelectListItem
                    {
                        Text = "4",
                        Value = "4",
                    });
                    antalPlaner.Add(new SelectListItem
                    {
                        Text = "5",
                        Value = "5",
                    });
                }

                    <div class="container-planinfo col-md-12">
                        <div class="planInfoSlide text-center">Planinformation <span id="planInfoSlideIco" class="glyphicon glyphicon-chevron-down" aria-hidden="true"></span></div>
                        <div id="P-toggle">
                            <span class="glyphicon glyphicon-question-sign pull-right hjalpKnapp" aria-hidden="true" style="margin-right:2%;" ><span class="hjalpText">Välj typ av fotbollsplan samt antal. Fritextrutan är till för extra information du vill lämna, max 150 tecken får användas. <br /><br /> Alla fotbollsplaner oavsett storlek räknas som fullstora.</span></span>

                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label col-md-4" for="AntalGräs">Antal gräsplaner</label>
                                    <div class="col-md-8">
                                        @Html.DropDownListFor(model => model.AntalGras, antalPlaner, null, htmlAttributes: new { @class = "form-control" })
                                        @Html.ValidationMessageFor(model => model.AntalGras, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-4" for="AntalGrus">Antal grusplaner</label>
                                    <div class="col-md-8">
                                        @Html.DropDownListFor(model => model.AntalGrus, antalPlaner, null, htmlAttributes: new { @class = "form-control" })
                                        @Html.ValidationMessageFor(model => model.AntalGrus, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-md-4" for="AntalKonstGras">Antal konstgräsplaner</label>
                                    <div class="col-md-8">
                                        @Html.DropDownListFor(model => model.AntalKonstGras, antalPlaner, null, htmlAttributes: new { @class = "form-control" })
                                        @Html.ValidationMessageFor(model => model.AntalKonstGras, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    @Html.LabelFor(model => model.Fritext, htmlAttributes: new { @class = "control-label col-md-3" })
                                    <div class="col-md-8">
                                        <textarea class="form-control" rows="5" id="Fritext" name="Fritext"></textarea>
                                        @Html.ValidationMessageFor(model => model.Fritext, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>

                            @{
                                List<SelectListItem> jaNej = new List<SelectListItem>();
                                jaNej.Add(new SelectListItem
                                {
                                    Text = "-",
                                    Value = ""
                                });
                                jaNej.Add(new SelectListItem
                                {
                                    Text = "Ja",
                                    Value = "True"
                                });
                                jaNej.Add(new SelectListItem
                                {
                                    Text = "Nej",
                                    Value = "False"
                                });
                            }
                            </div>
                        </div>


                        <div class="container-tillgängligt col-md-12">
                            <div class="tillgängligtSlide text-center">Tillgängligheter <span id="tillgängligtSlideIco" class="glyphicon glyphicon-chevron-down" aria-hidden="true"></span></div>
                            <div id="T-toggle">
                                <span class="glyphicon glyphicon-question-sign pull-right hjalpKnapp" aria-hidden="true" style="margin-right:2%;"><span class="hjalpText">Välj Ja alternativt Nej för respektive facilitet på den aktuella fotbollsplanen.</span></span>
                                <p class="text-primary text-center" style="left:0; margin-top: 2%; margin-left: 2%; margin-bottom:0;">Dessa faciliteter gäller inom ett avstånd på 500 meter från fotbollsplanen/fotbollsplanerna.</p>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="Parkering">Parkering<span class="red">*</span></label>
                                        <div class="col-md-9">
                                            @Html.DropDownListFor(model => model.Parkering, jaNej, null, htmlAttributes: new { @class = "form-control" })
                                            @Html.ValidationMessageFor(model => model.Parkering, "", new { @class = "text-danger" })
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="Omkladningsrum">Omklädningsrum<span class="red">*</span></label>
                                        <div class="col-md-9">
                                            @Html.DropDownListFor(model => model.Omkladnadsrum, jaNej, htmlAttributes: new { @class = "form-control" })
                                            @Html.ValidationMessageFor(model => model.Omkladnadsrum, "", new { @class = "text-danger" })
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="Kafe">Kafé<span class="red">*</span></label>
                                        <div class="col-md-9">
                                            @Html.DropDownListFor(model => model.Kafe, jaNej, htmlAttributes: new { @class = "form-control" })
                                            @Html.ValidationMessageFor(model => model.Kafe, "", new { @class = "text-danger" })
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="Restaurang">Restaurang<span class="red">*</span></label>
                                        <div class="col-md-9">
                                            @Html.DropDownListFor(model => model.Restaurang, jaNej, null, htmlAttributes: new { @class = "form-control" })
                                            @Html.ValidationMessageFor(model => model.Restaurang, "", new { @class = "text-danger" })
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="Upplyst">Upplyst<span class="red">*</span></label>
                                        <div class="col-md-9">
                                            @Html.DropDownListFor(model => model.Upplyst, jaNej, null, htmlAttributes: new { @class = "form-control" })
                                            @Html.ValidationMessageFor(model => model.Upplyst, "", new { @class = "text-danger" })
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-md-3" for="Bokning">Bokning<span class="red">*</span></label>
                                        <div class="col-md-9">
                                            @Html.DropDownListFor(model => model.Bokning, jaNej, null, htmlAttributes: new { @class = "form-control" })
                                            @Html.ValidationMessageFor(model => model.Bokning, "", new { @class = "text-danger" })
                                        </div>
                                    </div>
                                </div>
                            </div>
                         </div>



                        @*<div class="form-group">*@
                            <div class="col-md-offset-5 col-md-2">
                                <input type="submit" id="läggtillFP" value="Lägg till" class="btn btn-default" style="width:100%; font-size: larger; background-color: #2ab74b;"/>
                            </div>
                            <div class="col-md-5"></div>
                        @*</div>*@
                    </div>

        }



        @*<div>
            @Html.ActionLink("Back to List", "Index")
        </div>*@

        @section Scripts {
            @Scripts.Render("~/bundles/jqueryval")
        }
    </div>
</div>


<script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBdYS_UAzWfdbIIbydr7rIwpvqtKCUUEBY&callback=myMap"></script>
